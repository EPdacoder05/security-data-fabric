# ==============================================================================
# Security Data Fabric - Environment Configuration Template
# ==============================================================================
# 
# INSTRUCTIONS:
# 1. Copy this file to .env: cp .env.example .env
# 2. Replace all placeholder values with your actual configuration
# 3. NEVER commit .env file to version control
# 4. Regenerate all secrets for production deployments
#
# ==============================================================================

# ==============================================================================
# APPLICATION CONFIGURATION
# ==============================================================================

# Environment: development, staging, production
APP_ENV=production

# Application name
APP_NAME="Security Data Fabric"

# Application version (automatically set from pyproject.toml)
APP_VERSION=1.0.0

# Debug mode (NEVER enable in production)
DEBUG=false

# Log level: debug, info, warning, error, critical
LOG_LEVEL=info

# Server host and port
HOST=0.0.0.0
PORT=8000

# Number of worker processes (CPU cores * 2 + 1)
WORKERS=4

# ==============================================================================
# SECURITY - CORE SECRETS
# ==============================================================================

# Application secret key (256-bit, generate with: openssl rand -hex 32)
SECRET_KEY=your-secret-key-here-replace-me-32-characters-min

# JWT secret key (256-bit, generate with: openssl rand -hex 32)
JWT_SECRET_KEY=your-jwt-secret-key-here-replace-me-32-chars

# JWT algorithm (HS256, HS512, RS256)
JWT_ALGORITHM=HS256

# Access token expiration (minutes)
ACCESS_TOKEN_EXPIRE_MINUTES=30

# Refresh token expiration (days)
REFRESH_TOKEN_EXPIRE_DAYS=7

# Encryption key for field-level encryption (base64, generate with: openssl rand -base64 32)
ENCRYPTION_KEY=your-base64-encryption-key-here-replace-me

# ==============================================================================
# DATABASE CONFIGURATION
# ==============================================================================

# PostgreSQL connection URL
# Format: postgresql+asyncpg://user:password@host:port/database
DATABASE_URL=postgresql+asyncpg://securityfabric:changeme@postgres:5432/security_fabric

# Alternative: Individual components
POSTGRES_USER=securityfabric
POSTGRES_PASSWORD=changeme-generate-strong-password
POSTGRES_DB=security_fabric
POSTGRES_HOST=postgres
POSTGRES_PORT=5432

# Database pool settings
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=10
DATABASE_POOL_TIMEOUT=30
DATABASE_POOL_RECYCLE=3600

# Database query timeout (seconds)
DATABASE_QUERY_TIMEOUT=30

# Enable SQL query logging (development only)
DATABASE_ECHO=false

# ==============================================================================
# REDIS CONFIGURATION
# ==============================================================================

# Redis connection settings
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_DB=0

# Redis password (generate with: openssl rand -base64 24)
REDIS_PASSWORD=changeme-generate-strong-redis-password

# Redis SSL/TLS
REDIS_SSL=false

# Redis connection pool
REDIS_MAX_CONNECTIONS=50
REDIS_SOCKET_TIMEOUT=5
REDIS_SOCKET_CONNECT_TIMEOUT=5

# Cache TTL (seconds)
CACHE_TTL=300
CACHE_ENABLED=true

# ==============================================================================
# AUTHENTICATION & AUTHORIZATION
# ==============================================================================

# Multi-factor authentication
MFA_ENABLED=true
MFA_ISSUER="Security Data Fabric"

# Password policy
PASSWORD_MIN_LENGTH=12
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_DIGITS=true
PASSWORD_REQUIRE_SPECIAL=true
PASSWORD_MAX_AGE_DAYS=90

# Account lockout
MAX_LOGIN_ATTEMPTS=5
ACCOUNT_LOCKOUT_DURATION_MINUTES=30

# Session settings
SESSION_TIMEOUT_MINUTES=30
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=strict

# ==============================================================================
# AZURE ACTIVE DIRECTORY (SSO)
# ==============================================================================

# Azure AD tenant configuration
AZURE_TENANT_ID=your-azure-tenant-id-here
AZURE_CLIENT_ID=your-azure-client-id-here
AZURE_CLIENT_SECRET=your-azure-client-secret-here

# Azure AD endpoints
AZURE_AUTHORITY=https://login.microsoftonline.com/your-tenant-id
AZURE_REDIRECT_URI=https://your-domain.com/auth/azure/callback

# Azure scopes
AZURE_SCOPES=openid,email,profile

# ==============================================================================
# AZURE KEY VAULT (Secret Management)
# ==============================================================================

# Azure Key Vault URL
AZURE_KEYVAULT_URL=https://your-keyvault-name.vault.azure.net/

# Service Principal (for Key Vault access)
# Uses AZURE_CLIENT_ID and AZURE_CLIENT_SECRET from above

# ==============================================================================
# OKTA (SSO Alternative)
# ==============================================================================

# Okta domain (e.g., dev-123456.okta.com)
OKTA_DOMAIN=your-okta-domain.okta.com

# Okta application credentials
OKTA_CLIENT_ID=your-okta-client-id-here
OKTA_CLIENT_SECRET=your-okta-client-secret-here

# Okta redirect URI
OKTA_REDIRECT_URI=https://your-domain.com/auth/okta/callback

# Okta API token (for management API)
OKTA_API_TOKEN=your-okta-api-token-here

# ==============================================================================
# OPENAI / GPT (ML & AI Features)
# ==============================================================================

# OpenAI API key
OPENAI_API_KEY=sk-your-openai-api-key-here

# OpenAI model selection
OPENAI_MODEL=gpt-4
OPENAI_TEMPERATURE=0.7
OPENAI_MAX_TOKENS=2000

# OpenAI organization (optional)
OPENAI_ORG_ID=your-openai-org-id

# ==============================================================================
# AZURE SENTINEL INTEGRATION
# ==============================================================================

# Azure Sentinel workspace
AZURE_SENTINEL_WORKSPACE_ID=your-workspace-id-here
AZURE_SENTINEL_SUBSCRIPTION_ID=your-subscription-id-here
AZURE_SENTINEL_RESOURCE_GROUP=your-resource-group-name

# Azure Sentinel API credentials (uses Azure AD credentials above)
AZURE_SENTINEL_ENABLED=false

# ==============================================================================
# SPLUNK INTEGRATION
# ==============================================================================

# Splunk HTTP Event Collector (HEC)
SPLUNK_URL=https://splunk.example.com:8088
SPLUNK_TOKEN=your-splunk-hec-token-here
SPLUNK_INDEX=security_fabric
SPLUNK_SOURCETYPE=security_fabric:api

# Splunk SSL verification
SPLUNK_VERIFY_SSL=true

# Splunk enabled
SPLUNK_ENABLED=false

# ==============================================================================
# AWS SECURITY HUB INTEGRATION
# ==============================================================================

# AWS credentials
AWS_ACCESS_KEY_ID=your-aws-access-key-id
AWS_SECRET_ACCESS_KEY=your-aws-secret-access-key
AWS_DEFAULT_REGION=us-east-1

# AWS Security Hub
AWS_SECURITY_HUB_ENABLED=false
AWS_SECURITY_HUB_ACCOUNT_ID=your-aws-account-id

# ==============================================================================
# MONITORING & OBSERVABILITY
# ==============================================================================

# Prometheus metrics
PROMETHEUS_PORT=9090
METRICS_ENABLED=true
METRICS_PATH=/metrics

# Application metrics
METRICS_INCLUDE_TIMESTAMP=true
METRICS_PREFIX=security_fabric

# Health check endpoint
HEALTH_CHECK_PATH=/health

# ==============================================================================
# LOGGING CONFIGURATION
# ==============================================================================

# Log format: json, text
LOG_FORMAT=json

# Log output: stdout, file, both
LOG_OUTPUT=stdout

# Log file path (if LOG_OUTPUT includes file)
LOG_FILE_PATH=/app/logs/app.log

# Log rotation
LOG_MAX_SIZE_MB=100
LOG_BACKUP_COUNT=10

# Structured logging
LOG_INCLUDE_TIMESTAMP=true
LOG_INCLUDE_HOSTNAME=true

# ==============================================================================
# RATE LIMITING
# ==============================================================================

# Global rate limits
RATE_LIMIT_ENABLED=true
RATE_LIMIT_PER_MINUTE=100
RATE_LIMIT_PER_HOUR=1000

# Per-endpoint rate limits (can be overridden)
AUTH_RATE_LIMIT_PER_MINUTE=5
API_RATE_LIMIT_PER_MINUTE=100

# ==============================================================================
# CORS CONFIGURATION
# ==============================================================================

# Allowed origins (comma-separated)
CORS_ORIGINS=https://app.example.com,https://dashboard.example.com

# CORS credentials
CORS_ALLOW_CREDENTIALS=true

# CORS methods
CORS_ALLOW_METHODS=GET,POST,PUT,DELETE,OPTIONS

# CORS headers
CORS_ALLOW_HEADERS=*

# CORS max age
CORS_MAX_AGE=3600

# ==============================================================================
# EMAIL CONFIGURATION (Alerts & Notifications)
# ==============================================================================

# SMTP server settings
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USERNAME=notifications@example.com
SMTP_PASSWORD=your-smtp-password-here

# SMTP encryption
SMTP_USE_TLS=true
SMTP_USE_SSL=false

# Email settings
EMAIL_FROM=security-fabric@example.com
EMAIL_FROM_NAME="Security Data Fabric"

# Alert recipients (comma-separated)
ALERT_EMAIL_RECIPIENTS=security-team@example.com,soc@example.com

# ==============================================================================
# WEBHOOK CONFIGURATION
# ==============================================================================

# Webhook endpoints for external integrations
WEBHOOK_SLACK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL
WEBHOOK_TEAMS_URL=https://outlook.office.com/webhook/YOUR/WEBHOOK/URL
WEBHOOK_PAGERDUTY_URL=https://events.pagerduty.com/YOUR/WEBHOOK/URL

# Webhook enabled
WEBHOOK_ENABLED=false

# ==============================================================================
# DATA RETENTION POLICIES
# ==============================================================================

# Bronze layer retention (raw data, in days)
BRONZE_RETENTION_DAYS=90

# Silver layer retention (cleansed data, in days)
SILVER_RETENTION_DAYS=365

# Gold layer retention (aggregated data, in days)
GOLD_RETENTION_DAYS=730

# Audit log retention (in days, typically longer for compliance)
AUDIT_LOG_RETENTION_DAYS=2555  # 7 years

# Archive old data to cold storage
ENABLE_DATA_ARCHIVAL=true
ARCHIVAL_STORAGE_PATH=/mnt/archive

# ==============================================================================
# ML & ANALYTICS CONFIGURATION
# ==============================================================================

# Anomaly detection settings
ANOMALY_DETECTION_ENABLED=true
ANOMALY_THRESHOLD=0.8
ANOMALY_MODEL=IsolationForest

# Vector similarity search
VECTOR_SEARCH_ENABLED=true
VECTOR_DIMENSION=768
SIMILARITY_THRESHOLD=0.85

# Batch processing
BATCH_SIZE=1000
BATCH_INTERVAL_SECONDS=60

# Model paths
ML_MODEL_PATH=/app/models
ML_MODEL_CACHE_SIZE=5

# ==============================================================================
# COMPLIANCE & GOVERNANCE
# ==============================================================================

# Compliance frameworks (comma-separated)
ENABLED_COMPLIANCE_FRAMEWORKS=SOC2,ISO27001,GDPR,HIPAA,PCI-DSS

# GDPR settings
GDPR_ENABLED=true
GDPR_DATA_RETENTION_DAYS=730
GDPR_ANONYMIZATION_ENABLED=true

# PII detection and masking
PII_DETECTION_ENABLED=true
PII_MASKING_ENABLED=true

# ==============================================================================
# BACKUP & DISASTER RECOVERY
# ==============================================================================

# Backup configuration
BACKUP_ENABLED=true
BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30

# Backup storage
BACKUP_STORAGE_TYPE=s3  # Options: s3, azure, gcs, local
BACKUP_STORAGE_PATH=s3://your-backup-bucket/security-fabric

# Backup encryption
BACKUP_ENCRYPTION_ENABLED=true
BACKUP_ENCRYPTION_KEY=your-backup-encryption-key-here

# ==============================================================================
# PERFORMANCE TUNING
# ==============================================================================

# API timeouts (seconds)
REQUEST_TIMEOUT=30
KEEPALIVE_TIMEOUT=5

# Async settings
MAX_CONCURRENT_REQUESTS=1000
MAX_CONCURRENT_TASKS=100

# Connection pool settings (HTTP clients)
HTTP_POOL_CONNECTIONS=100
HTTP_POOL_MAXSIZE=100

# ==============================================================================
# FEATURE FLAGS
# ==============================================================================

# Enable/disable specific features
FEATURE_VECTOR_SEARCH=true
FEATURE_ML_PREDICTIONS=true
FEATURE_REAL_TIME_ALERTS=true
FEATURE_COMPLIANCE_REPORTS=true
FEATURE_API_VERSIONING=true

# Experimental features (use with caution)
EXPERIMENTAL_FEATURES=false

# ==============================================================================
# TESTING & DEVELOPMENT
# ==============================================================================

# Test database (separate from production)
TEST_DATABASE_URL=postgresql+asyncpg://test:test@localhost:5433/test_security_fabric

# Mock external services in development
MOCK_EXTERNAL_APIS=false

# Enable API documentation
ENABLE_DOCS=true
DOCS_URL=/docs
REDOC_URL=/redoc

# ==============================================================================
# DOCKER & DEPLOYMENT
# ==============================================================================

# Build information
BUILD_DATE=2024-01-01T00:00:00Z
VERSION=1.0.0
GIT_COMMIT=abc123

# Container user
CONTAINER_USER=appuser
CONTAINER_UID=1000
CONTAINER_GID=1000

# ==============================================================================
# NETWORK & SECURITY
# ==============================================================================

# Bind to localhost only in production
BIND_ADDRESS=127.0.0.1

# Trusted proxy IPs (for X-Forwarded-For headers)
TRUSTED_PROXIES=127.0.0.1,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16

# Security headers
ENABLE_SECURITY_HEADERS=true
HSTS_MAX_AGE=31536000
CSP_POLICY="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'"

# ==============================================================================
# NOTES
# ==============================================================================
#
# Security Best Practices:
# - Generate all secrets using cryptographically secure random generators
# - Use different secrets for development, staging, and production
# - Rotate secrets regularly (every 90 days minimum)
# - Store production secrets in Azure Key Vault or similar secret management system
# - Never share .env files or commit them to version control
# - Use least privilege principle for all credentials
# - Enable MFA wherever possible
# - Monitor for suspicious activity and unauthorized access
# - Keep dependencies updated and scan for vulnerabilities
# - Implement defense in depth with multiple security layers
#
# Quick Secret Generation Commands:
# - SECRET_KEY: openssl rand -hex 32
# - JWT_SECRET_KEY: openssl rand -hex 32
# - ENCRYPTION_KEY: openssl rand -base64 32
# - POSTGRES_PASSWORD: openssl rand -base64 24
# - REDIS_PASSWORD: openssl rand -base64 24
#
# ==============================================================================
